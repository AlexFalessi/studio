<?xml version="1.0" encoding="UTF-8"?>
<job xmlns="urn:proactive:jobdescriptor:dev"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="urn:proactive:jobdescriptor:dev ../../src/scheduler/src/org/ow2/proactive/scheduler/common/xml/schemas/jobdescriptor/dev/schedulerjob.xsd"
     name="example" priority="low" projectName="ex" cancelJobOnError="true">

  <variables>
	<variable name="root" value="${pa.scheduler.home}/samples/jobs_descriptors/Workflow/branching"/>
  </variables>

  <taskFlow>

    <task name="A">
	  <pre>
		<script>
          <file path="${root}/clean_tmp.js">
			<arguments>
			  <argument value="${root}" />
			</arguments>
		  </file>
		</script>
	  </pre>
	  <nativeExecutable>
        <staticCommand value="${root}/getline.sh">
		  <arguments>
			<argument value="${root}/" />
		  </arguments>
		</staticCommand>
	  </nativeExecutable>
	  <controlFlow block="start">
			 <if target="B1" else="B2" continuation="C">
			   <script>
				 <file path="${root}/if.js">
				   <arguments>
					 <argument value="${root}" />
				   </arguments>
				 </file>
			   </script>
			 </if>
	  </controlFlow>
	</task>
    <task name="B1">
	  <nativeExecutable>
        <staticCommand value="${root}/line1.sh">
		  <arguments>
			<argument value="${root}/" />
		  </arguments>
		</staticCommand>
	  </nativeExecutable>
	</task>
    <task name="B2">
	  <nativeExecutable>
        <staticCommand value="${root}/line2.sh">
		  <arguments>
			<argument value="${root}/" />
		  </arguments>
		</staticCommand>
	  </nativeExecutable>
	</task>

    <task name="C">
	  <nativeExecutable>
        <staticCommand value="${root}/putline.sh">
		  <arguments>
			<argument value="${root}/" />
		  </arguments>
		</staticCommand>
	  </nativeExecutable>
	  <controlFlow block="end">
		<loop target="A">
          <script>
			<file path="${root}/loop.js">
			  <arguments>
				<argument value="${root}" />
			  </arguments>
			</file>
          </script>
		</loop>
	  </controlFlow>
	</task>


  </taskFlow>
</job>
